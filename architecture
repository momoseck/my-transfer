<mxfile host="app.diagrams.net" modified="2026-02-13T00:00:00.000Z" agent="ChatGPT" version="24.7.7" type="device">
  <diagram id="move-to-caas" name="Move to CaaS - Target Architecture">
    <mxGraphModel dx="1300" dy="750" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="t1" value="Architecture Cible – Refonte E-Market – Move to CaaS (Event-Driven + JobRunr)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=22;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="20" width="1520" height="40" as="geometry"/>
        </mxCell>

        <!-- OpenShift container -->
        <mxCell id="ocp" value="OpenShift Cluster / Namespace emarket-*" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;strokeColor=#6c8ebf;fillColor=#dae8fc;align=left;verticalAlign=top;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="90" width="1680" height="760" as="geometry"/>
        </mxCell>

        <!-- Users -->
        <mxCell id="u1" value="Users&#xa;Sales / BO" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;fontSize=14;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="60" y="170" width="180" height="80" as="geometry"/>
        </mxCell>

        <!-- Front/API layer -->
        <mxCell id="fe" value="Frontend&#xa;(JSF / React)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1a73e8;fillColor=#d0e2ff;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="220" y="170" width="220" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="gw" value="API Gateway / Ingress&#xa;(Routes)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1a73e8;fillColor=#d0e2ff;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="460" y="170" width="240" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="bff" value="BFF / API Service" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1a73e8;fillColor=#d0e2ff;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="720" y="170" width="220" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="kc" value="Keycloak&#xa;(SSO / OIDC)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1a73e8;fillColor=#d0e2ff;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="720" y="280" width="220" height="70" as="geometry"/>
        </mxCell>

        <!-- Domain services -->
        <mxCell id="core" value="E-Market Core Service" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2d7600;fillColor=#d5e8d4;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="260" y="420" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="db" value="App DB&#xa;(Oracle / PostgreSQL)" style="shape=cylinder;whiteSpace=wrap;html=1;boundedLbl=1;strokeColor=#666666;fillColor=#f5f5f5;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="280" y="540" width="220" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="marg" value="Marge Service" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2d7600;fillColor=#d5e8d4;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="580" y="420" width="240" height="90" as="geometry"/>
        </mxCell>

        <!-- Messaging & Jobs -->
        <mxCell id="kaf" value="Kafka / Event Bus" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#b58e00;fillColor=#fff2cc;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="920" y="420" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="send" value="Sender Service&#xa;(Outbox + Publishing)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#b58e00;fillColor=#fff2cc;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1220" y="420" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="jr" value="JobRunr Workers" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#d07900;fillColor=#ffe6cc;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1220" y="540" width="260" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="jrdb" value="JobRunr Storage DB" style="shape=cylinder;whiteSpace=wrap;html=1;boundedLbl=1;strokeColor=#666666;fillColor=#f5f5f5;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1220" y="640" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="cftad" value="CFT Adapter&#xa;(SFTP/FTPS/CFT)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#d07900;fillColor=#ffe6cc;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1510" y="540" width="260" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="inad" value="Inbound Adapter&#xa;(Mx return → Events)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#d07900;fillColor=#ffe6cc;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1510" y="420" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- External systems (outside OCP) -->
        <mxCell id="cft" value="CFT" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#b85450;fillColor=#f8cecc;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1510" y="880" width="180" height="70" as="geometry"/>
        </mxCell>
        <mxCell id="mx" value="Murex" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#b85450;fillColor=#f8cecc;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="1710" y="880" width="180" height="70" as="geometry"/>
        </mxCell>

        <!-- Observability -->
        <mxCell id="obs" value="Observability&#xa;(Logs / Metrics / Tracing)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#6c6c6c;fillColor=#eeeeee;fontSize=12;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="980" y="720" width="420" height="90" as="geometry"/>
        </mxCell>

        <!-- Edges -->
        <mxCell id="e1" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="u1" target="fe">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e2" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="fe" target="gw">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e3" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="gw" target="bff">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e4" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="bff" target="core">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e5" value="OIDC / JWT" style="endArrow=open;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="bff" target="kc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e6" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="core" target="db">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e7" value="TradeValidated (event)" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="core" target="kaf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e8" value="consume" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="kaf" target="marg">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e9" value="MarginCalculated (event)" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="marg" target="kaf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e10" value="consume" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="kaf" target="send">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e11" value="enqueue jobs" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="send" target="jr">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e12" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="jr" target="jrdb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e13" value="send" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="jr" target="cftad">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e14" value="files/messages" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="cftad" target="cft">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e15" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="cft" target="mx">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e16" value="returns" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="mx" target="cft">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e17" value="inbound" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="cft" target="inad">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e18" value="MxResponseReceived (event)" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="inad" target="kaf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e19" value="TradeStatusUpdated" style="endArrow=block;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="kaf" target="core">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e20" style="endArrow=open;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="core" target="obs">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e21" style="endArrow=open;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="marg" target="obs">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e22" style="endArrow=open;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="send" target="obs">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e23" style="endArrow=open;dashed=1;html=1;strokeWidth=2;" edge="1" parent="1" source="inad" target="obs">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>